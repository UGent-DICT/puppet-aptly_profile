<%- |
  String $api_path,
  Stdlib::Absolutepath $auth_file,
  String $auth_type,
  String $repo_name,
  Array[String] $allow_from,
|
$api_paths = [
  "^${api_path}/+(repos|publish)/+${repo_name}",
  "^${api_path}/+files/+${repo_name}",
].join('|')
-%>
# Restrict access for repository <%= $repo_name %>
<LocationMatch "<%= $api_paths %>">
  AuthType <%= $auth_type %>
  AuthBasicProvider file
  AuthUserFile <%= $auth_file %>
  Require user <%= $allow_from.join(' ') %>
</LocationMatch>
